svgEditor.addExtension("server_opensave",{callback:function(){function e(t){function a(){t.submit(),e(t),$.process_cancel("Uploading...",function(){n=!0,$("#dialog_box").hide()})}t.empty();var o=$('<input type="file" name="svg_file">').appendTo(t);t[0]==p[0]?o.change(function(){svgEditor.openPrep(function(n){return n?(a(),void 0):(e(t),void 0)})}):o.change(function(){a()})}{var t="/assets/svg-edit-2.6/extensions/filesave.php",a="/assets/svg-edit-2.6/extensions/filesave.php";$('<iframe name="output_frame" src="#"/>').hide().appendTo("body")}if(svgEditor.setCustomHandlers({save:function(e,a){{var n='<?xml version="1.0"?>\n'+a,o=svgCanvas.getDocumentTitle(),i=o.replace(/[^a-z0-9\.\_\-]+/gi,"_");$("<form>").attr({method:"post",action:t,target:"output_frame"}).append('<input type="hidden" name="output_svg" value="'+encodeURI(n)+'">').append('<input type="hidden" name="filename" value="'+i+'">').appendTo("body").submit().remove()}},pngsave:function(e,t){var n=t.issues;$("#export_canvas").length||$("<canvas>",{id:"export_canvas"}).hide().appendTo("body");var o=$("#export_canvas")[0];o.width=svgCanvas.contentW,o.height=svgCanvas.contentH,canvg(o,t.svg,{renderCallback:function(){var e=o.toDataURL("image/png"),t=(svgEditor.uiStrings,"");if(n.length){var i="\n â€¢ ";t+="\n\n"+i+n.join(i)}t.length&&alert(t);{var s=svgCanvas.getDocumentTitle(),p=s.replace(/[^a-z0-9\.\_\-]+/gi,"_");$("<form>").attr({method:"post",action:a,target:"output_frame"}).append('<input type="hidden" name="output_png" value="'+e+'">').append('<input type="hidden" name="filename" value="'+p+'">').appendTo("body").submit().remove()}}})}}),!window.FileReader){var n=!1,o="extensions/fileopen.php?type=load_svg",i="extensions/fileopen.php?type=import_svg",s="extensions/fileopen.php?type=import_img";svgEditor.processFile=function(e,t){if(n)return n=!1,void 0;if($("#dialog_box").hide(),"import_img"!=t)var a=svgCanvas.Utils.decode64(e);switch(t){case"load_svg":svgCanvas.clear(),svgCanvas.setSvgString(a),svgEditor.updateCanvas();break;case"import_svg":svgCanvas.importSvgString(a),svgEditor.updateCanvas();break;case"import_img":svgCanvas.setGoodImage(e)}};var p=$("<form>");p.attr({enctype:"multipart/form-data",method:"post",action:o,target:"output_frame"});var r=p.clone().attr("action",i),v=p.clone().attr("action",s);e(p),e(r),e(v),$("#tool_open").show().prepend(p),$("#tool_import").show().prepend(r),$("#tool_image").prepend(v)}}});